"use strict";(self.webpackChunkbywater_blog=self.webpackChunkbywater_blog||[]).push([[8349],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>k});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=r.createContext({}),p=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(c.Provider,{value:t},e.children)},i={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),f=p(n),k=o,m=f["".concat(c,".").concat(k)]||f[k]||i[k]||a;return n?r.createElement(m,s(s({ref:t},u),{},{components:n})):r.createElement(m,s({ref:t},u))}));function k(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,s=new Array(a);s[0]=f;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:o,s[1]=l;for(var p=2;p<a;p++)s[p]=n[p];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}f.displayName="MDXCreateElement"},224:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>s,default:()=>u,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var r=n(7462),o=(n(7294),n(3905));const a={sidebar_position:14},s="[\u9435\u4eba\u8cfd 2022-\u64ca\u6557\u524d\u7aef\u9762\u8a66\u5927\u4f5c\u6230] React Hooks",l={unversionedId:"ironMan2022/react_hooks",id:"ironMan2022/react_hooks",isDocsHomePage:!1,title:"[\u9435\u4eba\u8cfd 2022-\u64ca\u6557\u524d\u7aef\u9762\u8a66\u5927\u4f5c\u6230] React Hooks",description:"\u4eca\u5929\u8981\u4f86\u804a React hooks\uff0cHooks \u5728 React 16.8 \u63a8\u51fa\uff0c\u5b83\u63d0\u4f9b\u4e86\u66f4\u4f4e\u7684\u5b78\u7fd2\u66f2\u7dda\u3001\u66f4\u9ad8\u7684\u53ef\u8b80\u6027\u548c\u66f4\u8f15\u9b06\u7684 debug\u3002\u9019\u7bc7\u6587\u7ae0\u6703\u9810\u8a2d\u4f60\u5df2\u7d93\u770b\u904e react \u7684hooks \u6587\u7ae0\uff0c\u4e26\u4e14\u5c0d hooks \u6709\u57fa\u672c\u7684\u4e86\u89e3\uff0c\u7136\u5f8c\u6211\u5011\u6703\u4ee5\u9762\u8a66\u7684\u554f\u7b54\u65b9\u5f0f\u4f86\u8a0e\u8ad6\u5e7e\u500b\u5e38\u898b\u7684 hooks\uff01",source:"@site/docs/ironMan2022/react_hooks.md",sourceDirName:"ironMan2022",slug:"/ironMan2022/react_hooks",permalink:"/bywater-blog/ironMan2022/react_hooks",tags:[],version:"current",sidebarPosition:14,frontMatter:{sidebar_position:14},sidebar:"tutorialSidebar",previous:{title:"[\u9435\u4eba\u8cfd 2022-\u64ca\u6557\u524d\u7aef\u9762\u8a66\u5927\u4f5c\u6230] React Reconciliation",permalink:"/bywater-blog/ironMan2022/react_reconciliation"},next:{title:"[\u9435\u4eba\u8cfd 2022-\u64ca\u6557\u524d\u7aef\u9762\u8a66\u5927\u4f5c\u6230] React 18",permalink:"/bywater-blog/ironMan2022/React18"}},c=[],p={toc:c};function u(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"\u9435\u4eba\u8cfd-2022-\u64ca\u6557\u524d\u7aef\u9762\u8a66\u5927\u4f5c\u6230-react-hooks"},"[\u9435\u4eba\u8cfd 2022-\u64ca\u6557\u524d\u7aef\u9762\u8a66\u5927\u4f5c\u6230]"," React Hooks"),(0,o.kt)("p",null,"\u4eca\u5929\u8981\u4f86\u804a React hooks\uff0cHooks \u5728 React 16.8 \u63a8\u51fa\uff0c\u5b83\u63d0\u4f9b\u4e86\u66f4\u4f4e\u7684\u5b78\u7fd2\u66f2\u7dda\u3001\u66f4\u9ad8\u7684\u53ef\u8b80\u6027\u548c\u66f4\u8f15\u9b06\u7684 debug\u3002\u9019\u7bc7\u6587\u7ae0\u6703\u9810\u8a2d\u4f60\u5df2\u7d93\u770b\u904e react \u7684",(0,o.kt)("a",{parentName:"p",href:"https://reactjs.org/docs/hooks-reference.html"},"hooks \u6587\u7ae0"),"\uff0c\u4e26\u4e14\u5c0d hooks \u6709\u57fa\u672c\u7684\u4e86\u89e3\uff0c\u7136\u5f8c\u6211\u5011\u6703\u4ee5\u9762\u8a66\u7684\u554f\u7b54\u65b9\u5f0f\u4f86\u8a0e\u8ad6\u5e7e\u500b\u5e38\u898b\u7684 hooks\uff01"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"hooks \u7684\u898f\u5247\uff1f")),(0,o.kt)("p",null,"\u56de\u7b54\uff1ahooks \u6709\u5169\u500b\u898f\u5247\uff0c\u7b2c\u4e00\u500b\u662f hooks \u53ea\u80fd\u5728\u6700\u9ad8\u5c64\u88ab\u547c\u53eb\uff0c\u4ee3\u8868 hooks \u4e0d\u80fd\u5728 if condition, function \u7b49\u60c5\u6cc1\u4e0b\u547c\u53eb\u3002\u7b2c\u4e8c\u500b\u662f hooks \u53ea\u80fd\u5728 React functional component \u6216\u662f custom hooks \u4e2d\u547c\u53eb\uff0c\u4e0d\u80fd\u5728 Js function \u4e2d\u4f7f\u7528\u3002"),(0,o.kt)("p",null,"follow up: \u70ba\u4ec0\u9ebc hooks \u53ea\u80fd\u5728\u6700\u9ad8\u5c64\u88ab\u547c\u53eb\uff1f",(0,o.kt)("br",{parentName:"p"}),"\n","\u56de\u7b54\uff1a\u56e0\u70ba React \u4f9d\u9760 hooks \u547c\u53eb\u7684\u9806\u5e8f\u3002"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://reactjs.org/docs/hooks-rules.html#explanation"},"https://reactjs.org/docs/hooks-rules.html#explanation")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"useEffect \u57f7\u884c\u9806\u5e8f\uff0cconsole.log \u7d50\u679c\u662f\u4ec0\u9ebc\uff1f")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'function Test({ name, children = null }) {\n  console.log("children", children);\n  useEffect(() => {\n    console.log(`${name} effect`);\n    return () => {\n      console.log(`${name} cleanup`);\n    };\n  });\n\n  return children;\n}\n\nfunction App() {\n  return (\n    <Test name="parent">\n      <Test name="child">123</Test>\n    </Test>\n  );\n}\n')),(0,o.kt)("p",null,"\u7bc4\u4f8b\u5728",(0,o.kt)("a",{parentName:"p",href:"https://codesandbox.io/s/boring-lena-9d2fnj"},"\u9019")),(0,o.kt)("p",null,"\u89e3\u984c\u601d\u8def\uff1a\u5728 React 16 \u4e2d\uff0c",(0,o.kt)("strong",{parentName:"p"},"mount \u7684\u9806\u5e8f\u662f\u7236\u7d44\u5efa => \u5b50\u7d44\u5efa\uff0ceffect \u7684\u9806\u5e8f\u662f\u5b50\u7d44\u5efa => \u7236\u7d44\u5efa"),"\u3002"),(0,o.kt)("p",null,"\u6ce8\u610f\uff1achild render \u5169\u6b21\uff0c\u56e0\u70ba\u4f7f\u7528 strict mode \u4e2d\u4e26\u4e14\u5728 dev \u74b0\u5883\u4e2d\uff0c\u5be6\u969b prod \u74b0\u5883\u53ea\u6703 render \u4e00\u6b21\u3002"),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"useRef\uff0cconsole.log \u7d50\u679c\u6703\u662f\u4ec0\u9ebc\uff1f")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'function App() {\n  const ref = useRef(null);\n  const [state, setState] = useState(1);\n\n  useEffect(() => {\n    setState(2);\n  }, []);\n\n  console.log("text", ref.current?.textContent);\n\n  return (\n    <div>\n      <div ref={state === 1 ? ref : null}>1</div>\n      <div ref={state === 2 ? ref : null}>2</div>\n    </div>\n  );\n}\n')),(0,o.kt)("p",null,"\u7bc4\u4f8b\u5728","[\u9019]","\uff08",(0,o.kt)("a",{parentName:"p",href:"https://codesandbox.io/s/objective-wood-hqxpqx?file=/src/App.js:111-413%EF%BC%89"},"https://codesandbox.io/s/objective-wood-hqxpqx?file=/src/App.js:111-413\uff09")),(0,o.kt)("p",null,"\u89e3\u984c\u601d\u8def\uff1aref \u6709\u5169\u500b\u91cd\u9ede\uff0c"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"ref \u7684\u503c\u4e0d\u6703\u56e0\u70ba re-render \u800c\u8b8a\u52d5\u3002"),(0,o.kt)("li",{parentName:"ul"},"\u66f4\u65b0 ref \u7684\u503c\u4e5f\u4e0d\u6703\u9020\u6210 re-render\u3002")),(0,o.kt)("p",null,"follow up\uff0c\u5982\u679c\u628a useEffect \u88e1\u9762\u7684[]\u62ff\u6389\uff0c\u7d50\u679c\u6703\u6539\u8b8a\u55ce\uff1f"),(0,o.kt)("p",null,"\u5982\u679c\u5c0d useRef \u9084\u662f\u6709\u9ede\u4e0d\u719f\u6089\u7684\u8a71\uff0c\u7b46\u8005\u5f88\u63a8\u9019\u7bc7",(0,o.kt)("a",{parentName:"p",href:"https://dmitripavlutin.com/react-useref-guide/"},"\u6587\u7ae0"),"\uff0c\u6211\u89ba\u5f97\u4ed6\u7528\u5f88\u6dfa\u986f\u7684\u5b57\u53e5\u628a useRef \u7684\u7528\u9014\u8b1b\u5f97\u5f88\u4ed4\u7d30\uff01"),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},"\u4ec0\u9ebc\u662f useImperativeHandle?")),(0,o.kt)("p",null,"\u89e3\u984c\u601d\u8def:useImperativeHandle \u53ef\u4ee5\u8b93\u7236\u7d44\u4ef6\u8f38\u51fa\u4efb\u610f\u6578\u64da\uff0c\u5176\u5fc5\u9808\u8981\u548c forwardRef \u4e00\u8d77\u4f7f\u7528\u3002"),(0,o.kt)("p",null,"\u4e0b\u9762\u770b\u7bc4\u4f8b\uff1a"),(0,o.kt)("p",null,"\u900f\u904e useImperativeHandle\uff0c\u6211\u5011\u8b93\u7236\u5c64\u53ef\u4ee5\u63a7\u5236\u5b50\u5c64\u7684 focus\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// \u900f\u904eforwardRef \u8b93FancyInput\u7ec4\u4ef6\u53ef\u4ee5\u63a5\u6536ref\nconst FancyInput = React.forwardRef(function FancyInput(props, ref) {\n  const inputRef = useRef();\n\n  // \u547d\u4ee4\u5f0f\u7684\u7ed9`ref.current`focus\n  useImperativeHandle(ref, () => ({\n    focus: () => {\n      inputRef.current.focus()\n    }\n  }));\n\n  return <input ref={inputRef} ... />\n})\n\n// Example\u7ec4\u4ef6\u4f5c\u4e3a\u7236\u7ec4\u4ef6\nfunction Example() {\n  const fancyInputRef = useRef()\n\n  const focus = () => {\n    fancyInputRef.current.focus()\n  }\n\n  return (\n    <>\n      <FancyInput ref={fancyInputRef} />\n    </>\n  )\n}\n\n")),(0,o.kt)("p",null,"\u5e0c\u671b\u9019\u4e9b\u984c\u76ee\uff0c\u80fd\u5920\u8b93\u8b80\u8005\u5c0d hooks \u6709\u4e00\u4e9b\u66f4\u6df1\u7684\u7406\u89e3\uff0chooks \u7684\u61c9\u7528\u6709\u975e\u5e38\u591a\uff0c\u5728\u77ed\u77ed\u4e00\u7bc7\u7684\u7bc7\u5e45\u5be6\u5728\u662f\u8b1b\u4e0d\u5b8c\uff0c\u9019\u88e1\u7b46\u8005\u53ea\u662f\u5217\u51fa\u5e7e\u500b\u6211\u89ba\u5f97\u883b\u6709\u8da3\u7684\u4f8b\u5b50\uff0c\u5176\u4ed6\u90e8\u5206\u5c31\u7b49\u8b80\u8005\u81ea\u5df1\u53bb\u7814\u7a76\u645f\uff5e\uff5e\uff5e"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://juejin.cn/post/7094651577117442056"},"https://juejin.cn/post/7094651577117442056"),"\n",(0,o.kt)("a",{parentName:"p",href:"https://segmentfault.com/a/1190000040758640"},"https://segmentfault.com/a/1190000040758640"),"\n",(0,o.kt)("a",{parentName:"p",href:"https://beta.reactjs.org/learn/state-as-a-snapshot"},"https://beta.reactjs.org/learn/state-as-a-snapshot")))}u.isMDXComponent=!0}}]);